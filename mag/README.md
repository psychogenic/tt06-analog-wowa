# Magic cells

This directory contains a bunch of sky130 junk, for reasons described below, but is essentially the spot for the

  - analogswitch
  - calibrated_comparator
  - comparator_stefan
  - lvtnot
  - onehot2mux
  - passgate
  - wowa_analog
  - wowa_digital
  - p3_opamp
  - r2r


cells that are part of the top *tt_um_psychogenic_wowa* cell.

The wowa_digital is a blob that was generated by openlane.  It would get munged by magic and then not pass final DRC, so the secret was to set 

gds readonly true
gds read wowa_digital.gds

and then save that magic cell -- resulting in a bunch of preserved sky130 logic cells in here.

Most of these has a corresponding schematic, symbol and testbench in xschem dir.

Assuming a compatible spice netlist was generated on that side (found in xschem/simulation) then

`PROJECT_NAME=xxx make clean lvs`

Will perform LVS, e.g.


`PROJECT_NAME=calibrated_comparator make clean lvs`

If that goes smashingly, it'll end with something like


```
...
Circuit 1 contains 4 devices, Circuit 2 contains 4 devices.
Circuit 1 contains 9 nets,    Circuit 2 contains 9 nets.


Final result: 
Circuits match uniquely.
.
Logging to file "lvs.report" disabled
LVS Done.
LVS OK
```

Otherwise, peer into the abyss that it lvs.report

